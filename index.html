<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Buon 2026 a 8bit - Alessandra!</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-dark: #0f0f23;
            --pixel-green: #00ff41;
            --pixel-cyan: #00ffff;
            --pixel-magenta: #ff00ff;
            --pixel-yellow: #ffff00;
            --pixel-red: #ff0040;
            --pixel-orange: #ff8c00;
            --pixel-pink: #ff69b4;
            --pixel-white: #ffffff;
            --pixel-gold: #ffd700;
        }
        html, body {
            font-family: 'Courier New', monospace;
            background: var(--bg-dark);
            min-height: 100vh;
            min-height: -webkit-fill-available;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        .scanlines {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1000;
            background: repeating-linear-gradient(0deg, rgba(0,0,0,0.08), rgba(0,0,0,0.08) 1px, transparent 1px, transparent 2px);
        }
        .game-container {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        .header { text-align: center; padding: 10px; width: 100%; }
        .title {
            font-size: clamp(20px, 6vw, 48px);
            color: var(--pixel-yellow);
            text-shadow: 3px 3px 0 var(--pixel-red), -2px -2px 0 var(--pixel-magenta);
            letter-spacing: 2px;
            animation: title-pulse 1s ease-in-out infinite alternate;
        }
        @keyframes title-pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.02); }
        }
        .subtitle {
            font-size: clamp(10px, 3vw, 18px);
            color: var(--pixel-cyan);
            margin-top: 8px;
        }
        .game-screen {
            width: 100%;
            max-width: 800px;
            height: clamp(180px, 35vw, 300px);
            background: linear-gradient(180deg, #000033 0%, #000066 50%, #003366 100%);
            border: 6px solid var(--pixel-cyan);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 15px var(--pixel-cyan);
        }
        .stars { position: absolute; width: 100%; height: 60%; top: 0; }
        .star {
            position: absolute;
            width: 3px; height: 3px;
            background: var(--pixel-white);
            animation: twinkle 1.5s ease-in-out infinite;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        .ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: clamp(35px, 8vw, 60px);
            background: repeating-linear-gradient(90deg, #4a2c00 0px, #4a2c00 20px, #5c3a00 20px, #5c3a00 40px);
            border-top: 6px solid var(--pixel-green);
        }
        .platform {
            position: absolute;
            height: 16px;
            background: #8B4513;
            border-top: 3px solid var(--pixel-green);
        }
        .character {
            position: absolute;
            bottom: clamp(35px, 8vw, 60px);
            left: 20px;
            width: 24px; height: 32px;
            z-index: 100;
            transform: scale(clamp(0.7, 1vw, 1));
            transform-origin: bottom left;
        }
        .pixel-char {
            position: absolute;
            width: 3px; height: 3px;
            background: transparent;
            box-shadow:
                6px 0 0 var(--pixel-yellow), 9px 0 0 var(--pixel-yellow), 12px 0 0 var(--pixel-yellow),
                3px 3px 0 var(--pixel-yellow), 6px 3px 0 var(--pixel-yellow), 9px 3px 0 var(--pixel-yellow), 12px 3px 0 var(--pixel-yellow), 15px 3px 0 var(--pixel-yellow),
                6px 6px 0 #ffcc99, 9px 6px 0 #ffcc99, 12px 6px 0 #ffcc99,
                3px 9px 0 #ffcc99, 6px 9px 0 #333, 9px 9px 0 #ffcc99, 12px 9px 0 #333, 15px 9px 0 #ffcc99,
                6px 12px 0 #ffcc99, 9px 12px 0 #ff6666, 12px 12px 0 #ffcc99,
                3px 15px 0 var(--pixel-magenta), 6px 15px 0 var(--pixel-magenta), 9px 15px 0 var(--pixel-magenta), 12px 15px 0 var(--pixel-magenta), 15px 15px 0 var(--pixel-magenta),
                3px 18px 0 var(--pixel-magenta), 6px 18px 0 var(--pixel-pink), 9px 18px 0 var(--pixel-pink), 12px 18px 0 var(--pixel-pink), 15px 18px 0 var(--pixel-magenta),
                3px 21px 0 var(--pixel-magenta), 6px 21px 0 var(--pixel-magenta), 9px 21px 0 var(--pixel-magenta), 12px 21px 0 var(--pixel-magenta), 15px 21px 0 var(--pixel-magenta),
                6px 24px 0 #ffcc99, 12px 24px 0 #ffcc99, 6px 27px 0 var(--pixel-red), 12px 27px 0 var(--pixel-red);
        }
        .character.walking .pixel-char { animation: walk 0.3s steps(2) infinite; }
        @keyframes walk {
            50% { box-shadow:
                6px 0 0 var(--pixel-yellow), 9px 0 0 var(--pixel-yellow), 12px 0 0 var(--pixel-yellow),
                3px 3px 0 var(--pixel-yellow), 6px 3px 0 var(--pixel-yellow), 9px 3px 0 var(--pixel-yellow), 12px 3px 0 var(--pixel-yellow), 15px 3px 0 var(--pixel-yellow),
                6px 6px 0 #ffcc99, 9px 6px 0 #ffcc99, 12px 6px 0 #ffcc99,
                3px 9px 0 #ffcc99, 6px 9px 0 #333, 9px 9px 0 #ffcc99, 12px 9px 0 #333, 15px 9px 0 #ffcc99,
                6px 12px 0 #ffcc99, 9px 12px 0 #ff6666, 12px 12px 0 #ffcc99,
                3px 15px 0 var(--pixel-magenta), 6px 15px 0 var(--pixel-magenta), 9px 15px 0 var(--pixel-magenta), 12px 15px 0 var(--pixel-magenta), 15px 15px 0 var(--pixel-magenta),
                3px 18px 0 var(--pixel-magenta), 6px 18px 0 var(--pixel-pink), 9px 18px 0 var(--pixel-pink), 12px 18px 0 var(--pixel-pink), 15px 18px 0 var(--pixel-magenta),
                3px 21px 0 var(--pixel-magenta), 6px 21px 0 var(--pixel-magenta), 9px 21px 0 var(--pixel-magenta), 12px 21px 0 var(--pixel-magenta), 15px 21px 0 var(--pixel-magenta),
                3px 24px 0 #ffcc99, 15px 24px 0 #ffcc99, 3px 27px 0 var(--pixel-red), 15px 27px 0 var(--pixel-red); }
        }
        .character.jumping { animation: jump 0.5s ease-out; }
        @keyframes jump { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-50px); } }
        .coin {
            position: absolute;
            width: clamp(10px, 2vw, 16px); 
            height: clamp(10px, 2vw, 16px);
            background: var(--pixel-yellow);
            border-radius: 50%;
            box-shadow: inset -3px -3px 0 var(--pixel-orange), 0 0 8px var(--pixel-yellow);
            animation: coin-float 1s ease-in-out infinite alternate;
        }
        @keyframes coin-float { 0% { transform: translateY(0); } 100% { transform: translateY(-4px); } }
        .goal-flag {
            position: absolute;
            right: clamp(20px, 5vw, 40px); 
            bottom: clamp(35px, 8vw, 60px);
            width: 6px; 
            height: clamp(50px, 10vw, 80px);
            background: #888;
        }
        .flag-banner {
            position: absolute;
            top: 0; left: 6px;
            width: clamp(25px, 5vw, 40px); 
            height: clamp(20px, 4vw, 30px);
            background: var(--pixel-red);
            clip-path: polygon(0 0, 100% 15%, 100% 85%, 0 100%);
            animation: flag-wave 0.5s ease-in-out infinite alternate;
        }
        .flag-banner::after {
            content: '2026';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(6px, 1.5vw, 10px);
            color: white;
            font-weight: bold;
        }
        @keyframes flag-wave { 0% { transform: skewY(0deg); } 100% { transform: skewY(3deg); } }
        .final-message {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            opacity: 0;
            visibility: hidden;
            z-index: 200;
            transition: opacity 0.5s, visibility 0.5s;
            width: 90%;
        }
        .final-message.show { opacity: 1; visibility: visible; }
        .final-message h2 {
            font-size: clamp(12px, 4vw, 28px);
            color: var(--pixel-yellow);
            text-shadow: 2px 2px 0 var(--pixel-red), -1px -1px 0 var(--pixel-magenta), 0 0 15px var(--pixel-yellow);
            animation: glow 0.5s ease-in-out infinite alternate;
        }
        @keyframes glow {
            0% { text-shadow: 2px 2px 0 var(--pixel-red), -1px -1px 0 var(--pixel-magenta), 0 0 15px var(--pixel-yellow); }
            100% { text-shadow: 2px 2px 0 var(--pixel-orange), -1px -1px 0 var(--pixel-pink), 0 0 30px var(--pixel-cyan); }
        }
        .firework {
            position: absolute;
            width: 3px; height: 3px;
            border-radius: 50%;
            animation: explode 1s ease-out forwards;
        }
        @keyframes explode { 0% { transform: scale(0); opacity: 1; } 100% { transform: scale(15); opacity: 0; } }
        
        /* MOBILE-OPTIMIZED TERMINAL */
        .terminal-container {
            width: 100%;
            max-width: 800px;
            background: #0a0a0a;
            border: 3px solid var(--pixel-green);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
        }
        .terminal-header {
            background: linear-gradient(90deg, #1a1a1a, #2a2a2a);
            padding: 6px 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            border-bottom: 2px solid var(--pixel-green);
        }
        .terminal-dot { width: 10px; height: 10px; border-radius: 50%; }
        .terminal-dot.red { background: var(--pixel-red); }
        .terminal-dot.yellow { background: var(--pixel-yellow); }
        .terminal-dot.green { background: var(--pixel-green); }
        .terminal-title { color: var(--pixel-green); font-size: clamp(10px, 2.5vw, 14px); margin-left: auto; }
        
        /* MOBILE ASCII - Using Canvas for better scaling */
        .terminal-body {
            padding: 10px;
            min-height: clamp(200px, 45vw, 320px);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        #asciiCanvas {
            width: 100%;
            height: 100%;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }
        
        /* Mobile greeting card fallback */
        .mobile-greeting {
            display: none;
            text-align: center;
            padding: 20px;
            color: var(--pixel-green);
        }
        
        .mobile-greeting h3 {
            color: var(--pixel-yellow);
            font-size: clamp(16px, 5vw, 24px);
            margin-bottom: 15px;
            text-shadow: 2px 2px 0 var(--pixel-red);
        }
        
        .mobile-greeting .year {
            font-size: clamp(32px, 10vw, 60px);
            color: var(--pixel-gold);
            font-weight: bold;
            text-shadow: 3px 3px 0 var(--pixel-orange), 0 0 20px var(--pixel-gold);
            margin: 15px 0;
            animation: year-pulse 1s ease-in-out infinite alternate;
        }
        
        @keyframes year-pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); text-shadow: 4px 4px 0 var(--pixel-red), 0 0 30px var(--pixel-yellow); }
        }
        
        .mobile-greeting .name {
            font-size: clamp(18px, 5vw, 28px);
            color: var(--pixel-magenta);
            margin: 10px 0;
        }
        
        .mobile-greeting .stars-row {
            font-size: clamp(20px, 6vw, 36px);
            margin: 10px 0;
            animation: stars-blink 0.8s ease-in-out infinite;
        }
        
        @keyframes stars-blink {
            0%, 100% { opacity: 1; color: var(--pixel-yellow); }
            50% { opacity: 0.7; color: var(--pixel-cyan); }
        }
        
        .mobile-greeting .message {
            font-size: clamp(12px, 3vw, 16px);
            color: var(--pixel-cyan);
            margin-top: 15px;
            font-style: italic;
        }
        
        .mobile-greeting .fireworks {
            font-size: clamp(24px, 7vw, 40px);
            margin-top: 10px;
        }
        
        /* Show mobile greeting on small screens */
        @media (max-width: 500px) {
            .ascii-text { display: none; }
            .mobile-greeting { display: block; }
        }
        
        .ascii-text {
            font-family: 'Courier New', monospace;
            font-size: clamp(5px, 1.1vw, 11px);
            line-height: 1.2;
            white-space: pre;
            color: var(--pixel-green);
        }
        
        .c { color: var(--pixel-cyan); }
        .y { color: var(--pixel-yellow); }
        .m { color: var(--pixel-magenta); }
        .r { color: var(--pixel-red); }
        .g { color: var(--pixel-green); }
        .w { color: var(--pixel-white); }
        .o { color: var(--pixel-orange); }
        .p { color: var(--pixel-pink); }
        .gold { color: var(--pixel-gold); }
        
        .audio-section { 
            width: 100%; 
            max-width: 800px; 
            text-align: center; 
            padding: 15px; 
        }
        
        /* iOS Audio Notice */
        .ios-notice {
            background: rgba(255, 140, 0, 0.2);
            border: 2px solid var(--pixel-orange);
            color: var(--pixel-orange);
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 8px;
            font-size: clamp(11px, 2.5vw, 14px);
            display: none;
        }
        
        .ios-notice.show {
            display: block;
            animation: pulse-border 1s ease-in-out infinite alternate;
        }
        
        @keyframes pulse-border {
            0% { border-color: var(--pixel-orange); box-shadow: 0 0 5px var(--pixel-orange); }
            100% { border-color: var(--pixel-yellow); box-shadow: 0 0 15px var(--pixel-yellow); }
        }
        
        .play-button {
            background: linear-gradient(180deg, var(--pixel-magenta) 0%, #aa0066 100%);
            color: white;
            border: 4px solid var(--pixel-pink);
            padding: clamp(12px, 3vw, 16px) clamp(20px, 5vw, 32px);
            font-size: clamp(14px, 3.5vw, 20px);
            font-family: 'Courier New', monospace;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 5px 0 #660044, 0 0 15px var(--pixel-magenta);
            transition: all 0.1s;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        .play-button:hover, .play-button:active { 
            transform: translateY(3px); 
            box-shadow: 0 2px 0 #660044, 0 0 20px var(--pixel-pink); 
        }
        .play-button.playing {
            background: linear-gradient(180deg, var(--pixel-green) 0%, #00aa00 100%);
            border-color: var(--pixel-cyan);
            box-shadow: 0 5px 0 #004400, 0 0 15px var(--pixel-green);
        }
        .audio-status { 
            margin-top: 12px; 
            font-size: clamp(12px, 2.5vw, 14px); 
            color: var(--pixel-cyan); 
            min-height: 20px; 
        }
        .audio-error {
            color: var(--pixel-red);
            background: rgba(255, 0, 64, 0.2);
            padding: 10px;
            border: 2px solid var(--pixel-red);
            margin-top: 10px;
            display: none;
            font-size: clamp(11px, 2.5vw, 14px);
        }
        .audio-error.show { display: block; }
        .footer { 
            text-align: center; 
            padding: 15px; 
            color: var(--pixel-cyan); 
            font-size: clamp(10px, 2.5vw, 12px); 
            opacity: 0.7; 
        }
        .footer span { 
            color: var(--pixel-red); 
            animation: heart 1s ease-in-out infinite; 
            display: inline-block; 
        }
        @keyframes heart { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        
        /* Better mobile layout */
        @media (max-width: 600px) {
            .game-container { padding: 10px; gap: 12px; }
            .game-screen { height: clamp(150px, 40vw, 200px); border-width: 4px; }
            .ground { height: 30px; border-top-width: 4px; }
            .character { bottom: 30px; }
            .goal-flag { bottom: 30px; }
            .platform { height: 12px; border-top-width: 2px; }
        }
        
        @media (max-width: 400px) {
            .game-screen { height: 140px; }
            .terminal-body { min-height: 180px; }
        }
    </style>
</head>
<body>
    <div class="scanlines"></div>
    <div class="game-container">
        <header class="header">
            <h1 class="title">â˜… CAPODANNO 2026 â˜…</h1>
            <p class="subtitle">&gt; Loading celebration.exe...</p>
        </header>
        <div class="game-screen" id="gameScreen">
            <div class="stars" id="stars"></div>
            <div class="platform" style="width: 80px; left: 120px; bottom: 90px;"></div>
            <div class="platform" style="width: 60px; left: 260px; bottom: 120px;"></div>
            <div class="platform" style="width: 90px; left: 400px; bottom: 100px;"></div>
            <div class="coin" style="left: 140px; bottom: 115px;"></div>
            <div class="coin" style="left: 275px; bottom: 145px;"></div>
            <div class="coin" style="left: 430px; bottom: 125px;"></div>
            <div class="coin" style="left: 520px; bottom: 70px;"></div>
            <div class="goal-flag"><div class="flag-banner"></div></div>
            <div class="character" id="character">
                <div class="character-body"><div class="pixel-char"></div></div>
            </div>
            <div class="ground"></div>
            <div class="final-message" id="finalMessage">
                <h2>ğŸ† Buon 2026 a 8bit Alessandra! ğŸ†</h2>
            </div>
        </div>
        <div class="terminal-container">
            <div class="terminal-header">
                <div class="terminal-dot red"></div>
                <div class="terminal-dot yellow"></div>
                <div class="terminal-dot green"></div>
                <span class="terminal-title">celebration.exe</span>
            </div>
            <div class="terminal-body" id="terminalBody">
                <!-- ASCII art for larger screens -->
                <div class="ascii-text" id="asciiText"></div>
                
                <!-- Mobile-friendly greeting card -->
                <div class="mobile-greeting">
                    <div class="stars-row">âœ¦ â˜… âœ¦ â˜… âœ¦</div>
                    <h3>HAPPY NEW YEAR</h3>
                    <div class="year">2026</div>
                    <div class="name">âœ¨ ALESSANDRA âœ¨</div>
                    <div class="stars-row">â˜… âœ¦ â˜… âœ¦ â˜…</div>
                    <div class="message">Che sia pieno di gioia e felicitÃ !</div>
                    <div class="fireworks">ğŸ† ğŸ‡ ğŸ†</div>
                </div>
            </div>
        </div>
        <div class="audio-section">
            <div class="ios-notice" id="iosNotice">
                ğŸ“± <strong>iPhone:</strong> Disattiva la modalitÃ  silenziosa (switch laterale) per sentire la musica!
            </div>
            <button class="play-button" id="playButton" onclick="toggleMusic()">â–¶ PLAY CHIPTUNE</button>
            <div class="audio-status" id="audioStatus"></div>
            <div class="audio-error" id="audioError">âš  ERRORE: Impossibile riprodurre l'audio.</div>
        </div>
        <footer class="footer">Made with <span>â™¥</span> in 8-bit style</footer>
    </div>
    <script>
// Detect iOS
const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

if (isIOS) {
    document.getElementById('iosNotice').classList.add('show');
}

// Simplified ASCII frames for better mobile display
const asciiFrames = [
`<span class="c">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>         <span class="y">â˜… â˜… â˜…</span>   <span class="m">H A P P Y   N E W   Y E A R</span>   <span class="y">â˜… â˜… â˜…</span>                     <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>                        <span class="y">      .    *    .      </span>                             <span class="c">â•‘</span>
<span class="c">â•‘</span>                        <span class="y">    *    *   *    *    </span>                             <span class="c">â•‘</span>
<span class="c">â•‘</span>                        <span class="y">      *    â˜…    *      </span>                             <span class="c">â•‘</span>
<span class="c">â•‘</span>       <span class="g">      *      </span>  <span class="g">       /\\       </span>   <span class="gold">   ___________   </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>       <span class="g">     /|\\     </span>  <span class="g">      /  \\      </span>   <span class="gold">  |   2026    |  </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>       <span class="g">    / | \\    </span>  <span class="g">     /____\\     </span>   <span class="gold">  |           |  </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>       <span class="g">   /  |  \\   </span>  <span class="g">    /      \\    </span>   <span class="gold">   \\_________/   </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>       <span class="g">  /   |   \\  </span>  <span class="g">   /________\\   </span>   <span class="gold">       | |       </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>       <span class="o">     [â–ˆ]     </span>  <span class="o">      [â–ˆâ–ˆ]      </span>   <span class="gold">     [_____]     </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>                  <span class="p">â™¥ â™¥ â™¥   A L E S S A N D R A   â™¥ â™¥ â™¥</span>                      <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>`,

`<span class="c">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>         <span class="m">â˜… â˜… â˜…</span>   <span class="y">H A P P Y   N E W   Y E A R</span>   <span class="m">â˜… â˜… â˜…</span>                     <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>            <span class="y">  *  </span>     <span class="m">  *  </span>     <span class="c">  *  </span>     <span class="r">  *  </span>     <span class="g">  *  </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>           <span class="y"> \\|/ </span>    <span class="m"> \\|/ </span>    <span class="c"> \\|/ </span>    <span class="r"> \\|/ </span>    <span class="g"> \\|/ </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>            <span class="y">-*- </span>     <span class="m">-*- </span>     <span class="c">-*- </span>     <span class="r">-*- </span>     <span class="g">-*- </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>           <span class="y"> /|\\ </span>    <span class="m"> /|\\ </span>    <span class="c"> /|\\ </span>    <span class="r"> /|\\ </span>    <span class="g"> /|\\ </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>            <span class="y">  *  </span>     <span class="m">  *  </span>     <span class="c">  *  </span>     <span class="r">  *  </span>     <span class="g">  *  </span>              <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>                 <span class="w"> â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— </span>                       <span class="c">â•‘</span>
<span class="c">â•‘</span>                 <span class="w">      â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• </span>                       <span class="c">â•‘</span>
<span class="c">â•‘</span>                 <span class="w"> â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— </span>                       <span class="c">â•‘</span>
<span class="c">â•‘</span>                 <span class="w"> â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—</span>                       <span class="c">â•‘</span>
<span class="c">â•‘</span>                 <span class="w"> â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•</span>                       <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>                  <span class="c">â˜… â˜… â˜…   A L E S S A N D R A   â˜… â˜… â˜…</span>                      <span class="c">â•‘</span>
<span class="c">â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>`,

`<span class="c">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>         <span class="r">â˜… â˜… â˜…</span>   <span class="c">H A P P Y   N E W   Y E A R</span>   <span class="r">â˜… â˜… â˜…</span>                     <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>                               <span class="w">  \\o/  </span>                                       <span class="c">â•‘</span>
<span class="c">â•‘</span>                               <span class="w">   |   </span>                                       <span class="c">â•‘</span>
<span class="c">â•‘</span>                               <span class="w">  / \\  </span>                                       <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>        <span class="g">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</span>          <span class="c">â•‘</span>
<span class="c">â•‘</span>        <span class="g">â•‘</span>                                                       <span class="g">â•‘</span>          <span class="c">â•‘</span>
<span class="c">â•‘</span>        <span class="g">â•‘</span>       <span class="gold">â˜… â˜… â˜…   B U O N   2 0 2 6   â˜… â˜… â˜…</span>          <span class="g">â•‘</span>          <span class="c">â•‘</span>
<span class="c">â•‘</span>        <span class="g">â•‘</span>                                                       <span class="g">â•‘</span>          <span class="c">â•‘</span>
<span class="c">â•‘</span>        <span class="g">â•‘</span>            <span class="p">A L E S S A N D R A !</span>                    <span class="g">â•‘</span>          <span class="c">â•‘</span>
<span class="c">â•‘</span>        <span class="g">â•‘</span>                                                       <span class="g">â•‘</span>          <span class="c">â•‘</span>
<span class="c">â•‘</span>        <span class="g">â•‘</span>       <span class="y">Che sia pieno di gioia e felicitÃ !</span>            <span class="g">â•‘</span>          <span class="c">â•‘</span>
<span class="c">â•‘</span>        <span class="g">â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>          <span class="c">â•‘</span>
<span class="c">â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>`,

`<span class="c">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>         <span class="gold">â˜… â˜… â˜…</span>   <span class="g">H A P P Y   N E W   Y E A R</span>   <span class="gold">â˜… â˜… â˜…</span>                     <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>                <span class="y">   *     </span>     <span class="m">   *     </span>     <span class="c">   *     </span>                    <span class="c">â•‘</span>
<span class="c">â•‘</span>                <span class="y">  /|\\    </span>     <span class="m">  /|\\    </span>     <span class="c">  /|\\    </span>                    <span class="c">â•‘</span>
<span class="c">â•‘</span>                <span class="y"> / | \\   </span>     <span class="m"> / | \\   </span>     <span class="c"> / | \\   </span>                    <span class="c">â•‘</span>
<span class="c">â•‘</span>                <span class="y">/  |  \\  </span>     <span class="m">/  |  \\  </span>     <span class="c">/  |  \\  </span>                    <span class="c">â•‘</span>
<span class="c">â•‘</span>                <span class="y">/   |   \\ </span>     <span class="m">/   |   \\ </span>     <span class="c">/   |   \\ </span>                    <span class="c">â•‘</span>
<span class="c">â•‘</span>                <span class="o">  [â–ˆâ–ˆ]   </span>     <span class="o">  [â–ˆâ–ˆ]   </span>     <span class="o">  [â–ˆâ–ˆ]   </span>                    <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>                   <span class="g">â™ª â™ª â™ª   AULD LANG SYNE   â™ª â™ª â™ª</span>                          <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>                  <span class="p">â™¥ â™¥ â™¥   A L E S S A N D R A   â™¥ â™¥ â™¥</span>                      <span class="c">â•‘</span>
<span class="c">â•‘</span>                                                                              <span class="c">â•‘</span>
<span class="c">â•‘</span>                        <span class="gold">âœ¦ Felice Anno Nuovo! âœ¦</span>                              <span class="c">â•‘</span>
<span class="c">â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>`
];

let currentFrame = 0;
let asciiInterval;

function startAscii() {
    const asciiText = document.getElementById('asciiText');
    if (asciiText) {
        asciiText.innerHTML = asciiFrames[0];
        asciiInterval = setInterval(() => {
            currentFrame = (currentFrame + 1) % asciiFrames.length;
            asciiText.innerHTML = asciiFrames[currentFrame];
        }, 1200);
    }
}

function generateStars() {
    const container = document.getElementById('stars');
    const numStars = window.innerWidth < 500 ? 15 : 25;
    for (let i = 0; i < numStars; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.animationDelay = Math.random() * 2 + 's';
        container.appendChild(star);
    }
}

const character = document.getElementById('character');
const gameScreen = document.getElementById('gameScreen');
const finalMessage = document.getElementById('finalMessage');
let charX = 20, isJumping = false, gameComplete = false;
const jumpPoints = [100, 240, 380];
let jumpIndex = 0;

function moveCharacter() {
    if (gameComplete) return;
    const goalX = gameScreen.offsetWidth - 80;
    if (jumpIndex < jumpPoints.length && charX >= jumpPoints[jumpIndex] && !isJumping) {
        isJumping = true;
        character.classList.add('jumping');
        setTimeout(() => { character.classList.remove('jumping'); isJumping = false; }, 500);
        jumpIndex++;
    }
    charX += 1.5;
    character.style.left = charX + 'px';
    character.classList.add('walking');
    document.querySelectorAll('.coin').forEach(coin => {
        if (Math.abs(charX - parseInt(coin.style.left)) < 25) {
            coin.style.transform = 'scale(0)';
            coin.style.opacity = '0';
            coin.style.transition = 'all 0.3s';
        }
    });
    if (charX >= goalX) {
        gameComplete = true;
        character.classList.remove('walking');
        for (let i = 0; i < 8; i++) setTimeout(() => {
            const colors = ['#ff0040', '#00ffff', '#ffff00', '#ff00ff', '#00ff41'];
            const fw = document.createElement('div');
            fw.className = 'firework';
            fw.style.left = Math.random() * 80 + 10 + '%';
            fw.style.top = Math.random() * 40 + 10 + '%';
            fw.style.background = colors[Math.floor(Math.random() * colors.length)];
            gameScreen.appendChild(fw);
            setTimeout(() => fw.remove(), 1000);
        }, i * 200);
        setTimeout(() => finalMessage.classList.add('show'), 500);
        return;
    }
    requestAnimationFrame(moveCharacter);
}

// AUDIO - With iOS workaround
let audioContext, isPlaying = false, loopTimeout;
const melody = [
    {n:'D4',d:0.5},{n:'G4',d:0.75},{n:'G4',d:0.25},{n:'G4',d:0.5},{n:'B4',d:0.5},
    {n:'A4',d:0.75},{n:'G4',d:0.25},{n:'A4',d:0.5},{n:'B4',d:0.25},{n:'A4',d:0.25},
    {n:'G4',d:0.75},{n:'G4',d:0.25},{n:'B4',d:0.5},{n:'D5',d:0.5},
    {n:'E5',d:1.5},{n:'E5',d:0.5},
    {n:'D5',d:0.75},{n:'B4',d:0.25},{n:'B4',d:0.5},{n:'G4',d:0.5},
    {n:'A4',d:0.75},{n:'G4',d:0.25},{n:'A4',d:0.5},{n:'B4',d:0.25},{n:'A4',d:0.25},
    {n:'G4',d:0.75},{n:'E4',d:0.25},{n:'E4',d:0.5},{n:'D4',d:0.5},
    {n:'G4',d:1.5},{n:'R',d:0.25},{n:'E5',d:0.25},
    {n:'D5',d:0.75},{n:'B4',d:0.25},{n:'B4',d:0.5},{n:'G4',d:0.5},
    {n:'A4',d:0.75},{n:'G4',d:0.25},{n:'A4',d:0.5},{n:'E5',d:0.5},
    {n:'D5',d:0.75},{n:'B4',d:0.25},{n:'B4',d:0.5},{n:'D5',d:0.5},
    {n:'E5',d:1.5},{n:'G5',d:0.5},
    {n:'D5',d:0.75},{n:'B4',d:0.25},{n:'B4',d:0.5},{n:'G4',d:0.5},
    {n:'A4',d:0.75},{n:'G4',d:0.25},{n:'A4',d:0.5},{n:'B4',d:0.25},{n:'A4',d:0.25},
    {n:'G4',d:0.75},{n:'E4',d:0.25},{n:'E4',d:0.5},{n:'D4',d:0.5},
    {n:'G4',d:2.0}
];
const freq = {R:0,D4:294,E4:330,G4:392,A4:440,B4:494,D5:587,E5:659,G5:784};

function createAudioContext() {
    if (audioContext) return audioContext;
    
    // iOS requires user gesture to create AudioContext
    const AudioContextClass = window.AudioContext || window.webkitAudioContext;
    audioContext = new AudioContextClass();
    
    // iOS silent mode workaround - create and play a silent buffer
    if (isIOS) {
        const silentBuffer = audioContext.createBuffer(1, 1, 22050);
        const source = audioContext.createBufferSource();
        source.buffer = silentBuffer;
        source.connect(audioContext.destination);
        source.start(0);
    }
    
    return audioContext;
}

function playNote(f, t, dur) {
    if (f === 0 || !audioContext) return;
    const osc = audioContext.createOscillator();
    const gain = audioContext.createGain();
    osc.type = 'square';
    osc.frequency.value = f;
    gain.gain.setValueAtTime(0, t);
    gain.gain.linearRampToValueAtTime(0.35, t + 0.01);
    gain.gain.setValueAtTime(0.25, t + dur - 0.1);
    gain.gain.linearRampToValueAtTime(0.001, t + dur);
    osc.connect(gain);
    gain.connect(audioContext.destination);
    osc.start(t);
    osc.stop(t + dur + 0.05);
    
    // Sub oscillator for fuller sound
    const sub = audioContext.createOscillator();
    const subGain = audioContext.createGain();
    sub.type = 'square';
    sub.frequency.value = f / 2;
    subGain.gain.setValueAtTime(0, t);
    subGain.gain.linearRampToValueAtTime(0.1, t + 0.01);
    subGain.gain.linearRampToValueAtTime(0.001, t + dur);
    sub.connect(subGain);
    subGain.connect(audioContext.destination);
    sub.start(t);
    sub.stop(t + dur + 0.05);
}

function playMelody() {
    if (!audioContext || !isPlaying) return;
    const bpm = 100;
    const beat = 60 / bpm;
    let t = audioContext.currentTime + 0.1;
    melody.forEach(note => {
        const f = freq[note.n];
        const dur = note.d * beat;
        if (f > 0) playNote(f, t, dur * 0.9);
        t += dur;
    });
    const total = melody.reduce((a, n) => a + n.d, 0) * beat;
    if (isPlaying) loopTimeout = setTimeout(() => { if (isPlaying) playMelody(); }, (total + 1) * 1000);
}

function toggleMusic() {
    const btn = document.getElementById('playButton');
    const status = document.getElementById('audioStatus');
    
    if (!isPlaying) {
        try {
            createAudioContext();
            
            if (audioContext.state === 'suspended') {
                audioContext.resume().then(() => {
                    startPlaying();
                });
            } else {
                startPlaying();
            }
            
            function startPlaying() {
                isPlaying = true;
                btn.textContent = 'â¸ STOP MUSIC';
                btn.classList.add('playing');
                status.textContent = 'â™ª Auld Lang Syne (8-bit) â™ª';
                playMelody();
                document.getElementById('audioError').classList.remove('show');
            }
        } catch (e) {
            document.getElementById('audioError').classList.add('show');
            console.error('Audio error:', e);
        }
    } else {
        isPlaying = false;
        btn.textContent = 'â–¶ PLAY CHIPTUNE';
        btn.classList.remove('playing');
        status.textContent = 'Music paused';
        if (loopTimeout) clearTimeout(loopTimeout);
        if (audioContext) { 
            audioContext.close().catch(() => {}); 
            audioContext = null; 
        }
    }
}

function attemptAutoplay() {
    const status = document.getElementById('audioStatus');
    // On mobile, don't attempt autoplay - just show instruction
    if (isIOS || /Android/i.test(navigator.userAgent)) {
        status.innerHTML = 'ğŸ‘† <strong>Tocca per la musica!</strong>';
        return;
    }
    
    try {
        createAudioContext();
        if (audioContext.state === 'running') {
            isPlaying = true;
            document.getElementById('playButton').textContent = 'â¸ STOP MUSIC';
            document.getElementById('playButton').classList.add('playing');
            status.textContent = 'â™ª Auld Lang Syne (8-bit) â™ª';
            playMelody();
        } else {
            status.innerHTML = 'ğŸ‘† <strong>Clicca per la musica!</strong>';
        }
    } catch (e) {
        status.innerHTML = 'ğŸ‘† <strong>Clicca per la musica!</strong>';
    }
}

window.addEventListener('load', () => {
    generateStars();
    startAscii();
    setTimeout(moveCharacter, 1500);
    setTimeout(attemptAutoplay, 500);
});

// Enable audio on first touch for iOS
document.addEventListener('touchstart', function() {
    if (!audioContext) {
        createAudioContext();
    }
    if (audioContext && audioContext.state === 'suspended') {
        audioContext.resume();
    }
}, { once: true, passive: true });

document.addEventListener('click', function() {
    if (!audioContext) {
        createAudioContext();
    }
    if (audioContext && audioContext.state === 'suspended') {
        audioContext.resume();
    }
}, { once: true });
    </script>
</body>
</html>
